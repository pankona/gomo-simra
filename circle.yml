machine:
    environment:
        IMPORT_PATH: "github.com/$CIRCLE_PROJECT_USERNAME/$CIRCLE_PROJECT_REPONAME"
        GOPATH: "$HOME/go"

dependencies:
    cache_directories:
        - $GOPATH

    pre:
        - mkdir -p $GOPATH
        - if [[ ! -e `which gomobile` ]]; then go get golang.org/x/mobile/cmd/gomobile; fi
        - gomobile init -v

    override:
        - echo $GOPATH
        - echo "$GOPATH/src/$IMPORT_PATH"
        - mkdir -p "$GOPATH/src/$IMPORT_PATH"
        - rsync -azC --delete ./ "$GOPATH/src/$IMPORT_PATH/"
        - cd "$GOPATH/src/$IMPORT_PATH/example" && gomobile build -v

test:
    override:
        - echo "test here!"
