
@startuml
hide footbox

participant main
participant "Driver\n(interface)" as driver
participant Engine as engine
participant GomobileApp as gomo
participant Peer as peer

main -> engine         : Initialize(driver)
activate engine

engine -> gomo         : Initialize()
activate gomo
engine <-- gomo
deactivate gomo

engine -> peer         : Initialize()
activate peer
engine <-- peer
deactivate peer

main <-- engine
deactivate engine

main -> engine         : Start()
activate engine
engine -> engine       : changedriver
note over engine       : currentdriver = driver1
engine -> driver       : Initialize()
activate driver
loop as much as needed
note over driver       : Define Sprite as variables
driver -> peer         : AddSprite(Sprite)
activate peer
note over peer         : Hold sprites\nas node
driver <-- peer
deactivate peer
end
engine <-- driver
deactivate driver
engine -> gomo         : Start()
activate gomo
engine <-- gomo
deactivate gomo
main <-- engine
deactivate engine

loop
gomo -> engine         : Update()
activate engine
engine -> driver       : Update() 
activate driver
note over driver       : Calculate position\nfor every sprite
engine <-- driver
deactivate driver
engine -> peer         : Update()
note over peer         : Draw for every\nadded sprite
activate peer
engine <-- peer
deactivate peer
gomo <-- engine
deactivate engine
end

engine <- driver      : driverEnd(Nextdriver)
activate engine
engine -> gomo         : Pause()
activate gomo 
note over gomo         : pause to call Update()
engine <-- gomo 
deactivate gomo

engine -> peer         : RemoveAllSprites()
activate peer
note over peer         : remove all nodes
engine <-- peer
deactivate peer

engine -> engine       : changedriver
note over engine       : currentdriver = driver2

engine -> driver       : Initialize()
activate driver
note over driver       : add sprites as well
driver -> peer
engine <-- driver
deactivate driver
engine -> gomo         : Start()
activate gomo
engine <-- gomo
deactivate gomo
driver <-- engine
deactivate engine

driver -> engine       : Stop()
activate engine
note over engine       : currentdriver = nil
engine -> peer         : Finalize()
activate peer
note over peer         : Cleanup if necessary
engine <-- peer
deactivate peer
driver <-- engine
deactivate engine

@enduml
